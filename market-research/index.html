<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Research on Listed companies</title>
    <style>
      :root {
        --animation-duration: 0.45s;
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
        height: 100vh;
        overflow: hidden;
      }

      .container {
        display: flex;
        height: 100vh;
      }

      /* Side Panels */
      .sidebar {
        width: 280px;
        background: #bc1313;
        color: white;
        padding: 20px;
        overflow-y: auto;
        transition: all 0.3s ease;
        flex-shrink: 0;
      }

      #topicsSidebar {
        box-shadow: 2px 0 15px rgba(0, 0, 0, 0.1);
      }
      #companySidebar {
        box-shadow: -2px 0 15px rgba(0, 0, 0, 0.1);
      }

      .sidebar h2 {
        font-size: 1.4em;
        margin-bottom: 20px;
        text-align: center;
        border-bottom: 2px solid rgba(255, 255, 255, 0.3);
        padding-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .sidebar-item {
        padding: 12px 16px;
        margin: 8px 0;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        border-left: 4px solid transparent;
        font-weight: 500;
      }

      .sidebar-item:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateX(5px);
        border-left-color: white;
      }

      #companySidebar .sidebar-item:hover {
        transform: translateX(-5px);
      }

      .sidebar-item.active {
        background: rgba(255, 255, 255, 0.25);
        border-left-color: white;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }

      /* Main Content */
      .main-content {
        flex: 1;
        padding: 30px;
        background: white;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      .header {
        text-align: center;
        margin-bottom: 30px;
        padding: 20px;
        background: linear-gradient(135deg, #eb2627 0%, #bc1313 100%);
        color: white;
        border-radius: 12px;
        box-shadow: 0 8px 25px rgba(235, 38, 39, 0.3);
        flex-shrink: 0;
      }

      .header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }
      .header p {
        font-size: 1.1em;
        opacity: 0.9;
      }

      .content-area {
        background: white;
        border-radius: 12px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        border: 1px solid #e0e0e0;
        position: relative;
        overflow: hidden;
        flex-grow: 1;
      }

      .content-wrapper {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: white;
        transition: transform var(--animation-duration) ease-in-out,
          opacity var(--animation-duration) ease-in-out;
        overflow-y: auto;
        padding: 30px;
      }

      .welcome-screen {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100%;
        /* padding: 20px; */
        text-align: center;
        color: #a1a1a1;
        position: relative;
      }
      .welcome-screen .logo {
        position: absolute;
        top: -30px;
        right: -10px;
        height: 108px;
      }
      .welcome-screen h2 {
        color: #eb2627;
        font-size: 2em;
        margin-bottom: 20px;
      }
      .welcome-screen p {
        font-size: 1.1em;
        line-height: 1.6;
        margin-bottom: 15px;
      }

      .logo-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      .logo-wrapper img {
        width: auto;
        max-width: 400px;
        max-height: 200px;
        object-fit: contain;
        margin-bottom: 30px;
      }
      .company-name {
        color: #cecece;
        font-size: 1.5em;
        font-weight: 400;
        text-align: center;
      }
      .logo-placeholder-text {
        font-size: 1.5em;
        font-weight: 600;
        color: #aaa;
        text-align: center;
      }

      /* Animation states */
      .content-wrapper.prepare-enter-from-left {
        transform: translateX(-100%);
      }
      .content-wrapper.prepare-enter-from-right {
        transform: translateX(100%);
      }
      .content-wrapper.prepare-enter-from-top {
        transform: translateY(-100%);
      }
      .content-wrapper.prepare-enter-from-bottom {
        transform: translateY(100%);
      }
      .content-wrapper.prepare-fade {
        opacity: 0;
      }

      .content-wrapper.is-entering {
        transform: translateX(0);
        opacity: 1;
      }

      .content-wrapper.exit-to-left {
        transform: translateX(-100%);
      }
      .content-wrapper.exit-to-right {
        transform: translateX(100%);
      }
      .content-wrapper.exit-to-top {
        transform: translateY(-100%);
      }
      .content-wrapper.exit-to-bottom {
        transform: translateY(100%);
      }
      .content-wrapper.exit-fade {
        opacity: 0;
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: linear-gradient(135deg, #eb2627 0%, #bc1313 100%);
        color: white;
        padding: 20px;
        margin: -30px -30px 30px -30px;
        border-radius: 12px 12px 0 0;
      }

      .card-header h3 {
        font-size: 1.8em;
        margin-bottom: 8px;
      }
      .card-header p {
        opacity: 0.9;
        font-size: 1.1em;
      }

      .header-logo-container {
        background-color: rgba(255, 255, 255, 0.9);
        padding: 8px;
        border-radius: 6px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .header-logo {
        height: 40px;
        max-width: 120px;
        object-fit: contain;
      }

      .data-section {
        margin-bottom: 30px;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 8px;
        border-left: 4px solid #eb2627;
      }
      .data-section h4 {
        color: #bc1313;
        font-size: 1.3em;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
      }
      .data-section h4:before {
        content: "â–¶";
        margin-right: 10px;
        font-size: 0.8em;
      }

      .data-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 15px;
      }
      .data-item {
        background: white;
        padding: 15px;
        border-radius: 6px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        border: 1px solid #e0e0e0;
      }
      .data-item strong {
        color: #bc1313;
        display: block;
        margin-bottom: 5px;
      }

      /* Scrollbar Styling */
      .sidebar::-webkit-scrollbar,
      .content-wrapper::-webkit-scrollbar {
        width: 6px;
      }
      .sidebar::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
      }
      .sidebar::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 3px;
      }
      .content-wrapper::-webkit-scrollbar-track {
        background: #f1f1f1;
      }
      .content-wrapper::-webkit-scrollbar-thumb {
        background: #eb2627;
        border-radius: 3px;
      }

      /* Toast Notification */
      .toast-notification {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #333;
        color: white;
        padding: 12px 24px;
        border-radius: 25px;
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.4s ease, bottom 0.4s ease;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        font-size: 1em;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }
      .toast-notification.show {
        opacity: 1;
        bottom: 40px;
      }

      /* Desktop Tools */
      .desktop-tools {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
        padding: 20px 0 0 0;
        flex-shrink: 0;
      }
      .desktop-tools button {
        background: #fff;
        border: 1px solid #ddd;
        cursor: pointer;
        padding: 8px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.2s ease;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
      }
      .desktop-tools button:hover {
        background: #f5f5f5;
      }
      .desktop-tools #fullscreenBtn {
        font-size: 0.9em;
        padding: 8px 16px;
        border-radius: 20px;
      }

      /* Mobile UI */
      .mobile-header,
      #mobileCompanyNav,
      #mobileNavBackdrop {
        display: none;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .container {
          flex-direction: column;
          overflow-y: auto;
        }
        .sidebar {
          width: 100%;
          height: auto;
          max-height: none;
          flex-shrink: 0;
        }
        #companySidebar,
        .desktop-tools {
          display: none;
        }
        .main-content {
          padding: 0;
          overflow: visible;
        }
        .header {
          display: none;
        }
        .content-area {
          border-radius: 0;
          box-shadow: none;
          border: none;
        }
        .content-wrapper {
          padding: 15px;
        }
        .card-header {
          margin: -15px -15px 15px -15px;
        }

        .mobile-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 12px 15px;
          background: #bc1313;
          color: white;
          flex-shrink: 0;
          position: sticky;
          top: 0;
          z-index: 100;
        }
        #mobileTopicTitle {
          font-size: 1.2em;
        }
        #mobileCompanySelectorBtn {
          background: rgba(255, 255, 255, 0.2);
          border: none;
          color: white;
          padding: 8px 12px;
          border-radius: 6px;
          font-size: 0.9em;
        }

        #mobileCompanyNav {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: white;
          z-index: 1001;
          transform: translateY(100%);
          transition: transform 0.4s ease;
          display: flex;
          flex-direction: column;
        }
        #mobileCompanyNav.open {
          transform: translateY(0);
        }
        .mobile-nav-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 15px;
          border-bottom: 1px solid #eee;
          flex-shrink: 0;
        }
        .mobile-nav-header h2 {
          color: #bc1313;
        }
        #closeMobileNavBtn {
          font-size: 1.5em;
          border: none;
          background: none;
        }
        .mobile-nav-list {
          overflow-y: auto;
          padding: 10px;
        }
        .mobile-nav-list .sidebar-item {
          background: #f1f1f1;
          color: #333;
          border-left-color: #eb2627;
        }
        .mobile-nav-list .sidebar-item.active {
          background: #eb2627;
          color: white;
        }
        #mobileNavBackdrop {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.5);
          z-index: 1000;
          opacity: 0;
          pointer-events: none;
          transition: opacity 0.4s ease;
          display: block;
        }
        #mobileNavBackdrop.visible {
          opacity: 1;
          pointer-events: auto;
        }
      }
    </style>
  </head>
  <body>
    <div id="mobileNavBackdrop"></div>
    <div id="mobileCompanyNav">
      <div class="mobile-nav-header">
        <h2>Select Company</h2>
        <button id="closeMobileNavBtn">&times;</button>
      </div>
      <div class="mobile-nav-list"></div>
    </div>

    <div class="container">
      <!-- Topics Sidebar -->
      <div class="sidebar" id="topicsSidebar">
        <h2>Topics</h2>
        <div class="sidebar-item" data-topic="management">Management</div>
        <div class="sidebar-item" data-topic="financials">Financials</div>
        <div class="sidebar-item" data-topic="focus">Focus</div>
        <div class="sidebar-item" data-topic="supporting-files">
          Supporting Files
        </div>
        <div class="sidebar-item" data-topic="gdmr-entry">GDMR Entry Plan</div>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <div class="mobile-header">
          <h2 id="mobileTopicTitle">Topics</h2>
          <button id="mobileCompanySelectorBtn">Select Company</button>
        </div>
        <div class="header">
          <h1>Research on Listed Companies</h1>
          <p>Analysis of Leading Indian Retail Companies</p>
        </div>

        <div class="content-area">
          <div class="content-wrapper" id="contentContainer"></div>
        </div>
        <div class="desktop-tools">
          <button id="prevTopicBtn" title="Previous Topic">â—„</button>
          <button id="fullscreenBtn">Fullscreen</button>
          <button id="nextTopicBtn" title="Next Topic">â–º</button>
        </div>
      </div>

      <!-- Company Sidebar -->
      <div class="sidebar" id="companySidebar">
        <h2>Companies</h2>
        <div class="sidebar-item" data-company="reliance">Reliance</div>
        <div class="sidebar-item" data-company="titan">Titan</div>
        <div class="sidebar-item" data-company="shoppers">Shoppers</div>
        <div class="sidebar-item" data-company="abfrl">ABFRL</div>
        <div class="sidebar-item" data-company="page-industries">
          Page Industries
        </div>
        <div class="sidebar-item" data-company="v-mart">V-mart</div>
        <div class="sidebar-item" data-company="trent">Trent</div>
        <div class="sidebar-item" data-company="go-fashion">Go Fashion</div>
        <div class="sidebar-item" data-company="avenue-supermarts">
          Avenue Supermarts Ltd
        </div>
        <div class="sidebar-item" data-company="arvind-fashion">
          Arvind Fashion
        </div>
      </div>
    </div>

    <script>
      // Sample data structure for companies
      const companyData = {
        reliance: {
          name: "Reliance Industries Limited",
          logo: "logo/reliance-industries.svg",
          management: {
            sections: [
              {
                title: "Leadership Team",
                items: [
                  { label: "Chairman & MD", value: "Mukesh D. Ambani" },
                  { label: "Executive Director", value: "Akash M. Ambani" },
                  { label: "Executive Director", value: "Isha M. Ambani" },
                  { label: "Director", value: "Nita M. Ambani" },
                ],
              },
              {
                title: "Board Composition",
                items: [
                  { label: "Total Directors", value: "15" },
                  { label: "Independent Directors", value: "8" },
                  { label: "Executive Directors", value: "4" },
                  { label: "Women Directors", value: "3" },
                ],
              },
            ],
          },
          financials: {
            sections: [
              {
                title: "Key Financial Metrics (FY 2024)",
                items: [
                  { label: "Total Revenue", value: "â‚¹9,54,000 Cr" },
                  { label: "Net Profit", value: "â‚¹79,000 Cr" },
                  { label: "EBITDA", value: "â‚¹1,38,000 Cr" },
                  { label: "Market Cap", value: "â‚¹17,50,000 Cr" },
                ],
              },
              {
                title: "Segment Performance",
                items: [
                  { label: "Oil to Chemicals", value: "â‚¹6,34,000 Cr" },
                  { label: "Oil & Gas", value: "â‚¹85,000 Cr" },
                  { label: "Retail", value: "â‚¹2,30,000 Cr" },
                  { label: "Digital Services", value: "â‚¹1,01,000 Cr" },
                ],
              },
            ],
          },
          focus: {
            sections: [
              {
                title: "Strategic Priorities",
                items: [
                  {
                    label: "Digital Expansion",
                    value: "Jio 5G rollout across India",
                  },
                  {
                    label: "Retail Growth",
                    value: "18,000+ stores nationwide",
                  },
                  {
                    label: "Green Energy",
                    value: "â‚¹75,000 Cr investment by 2030",
                  },
                  {
                    label: "New Commerce",
                    value: "JioMart omnichannel platform",
                  },
                ],
              },
            ],
          },
          "supporting-files": {
            sections: [
              {
                title: "Annual Reports & Documents",
                items: [
                  {
                    label: "Annual Report 2024",
                    value: "Available for download",
                  },
                  { label: "Investor Presentation", value: "Q4 FY24 Results" },
                  { label: "Sustainability Report", value: "2024 ESG Report" },
                  { label: "Corporate Governance", value: "Board Report 2024" },
                ],
              },
            ],
          },
          "gdmr-entry": {
            sections: [
              {
                title: "Market Entry Strategy",
                items: [
                  {
                    label: "Target Markets",
                    value: "Tier 2 & 3 cities expansion",
                  },
                  {
                    label: "Investment Required",
                    value: "â‚¹50,000 Cr over 3 years",
                  },
                  {
                    label: "Partnership Model",
                    value: "Franchise and owned stores",
                  },
                  {
                    label: "Competitive Edge",
                    value: "Leveraging Jio's network",
                  },
                ],
              },
            ],
          },
        },
        titan: {
          name: "Titan Company Limited",
          logo: "logo/titan.png",
          management: {
            sections: [
              {
                title: "Leadership Team",
                items: [
                  { label: "MD & CEO", value: "C K Venkataraman" },
                  { label: "Executive Director", value: "S Subramaniam" },
                  { label: "CFO", value: "Dinesh Dayal" },
                  { label: "Chairman", value: "N Chandrasekaran" },
                ],
              },
            ],
          },
          financials: {
            sections: [
              {
                title: "Key Financial Metrics (FY 2024)",
                items: [
                  { label: "Total Revenue", value: "â‚¹38,500 Cr" },
                  { label: "Net Profit", value: "â‚¹3,400 Cr" },
                  { label: "EBITDA Margin", value: "12.8%" },
                  { label: "ROE", value: "18.5%" },
                ],
              },
            ],
          },
          focus: {
            sections: [
              {
                title: "Growth Initiatives",
                items: [
                  {
                    label: "Store Expansion",
                    value: "2,800+ retail touchpoints",
                  },
                  {
                    label: "Digital Strategy",
                    value: "Omnichannel excellence",
                  },
                  { label: "Product Innovation", value: "Lab-grown diamonds" },
                  { label: "International Presence", value: "40+ countries" },
                ],
              },
            ],
          },
          "supporting-files": {
            sections: [
              {
                title: "Reports & Analysis",
                items: [
                  { label: "Annual Report", value: "FY 2024 Complete Report" },
                  { label: "Quarterly Results", value: "Q1-Q4 Performance" },
                  {
                    label: "Industry Analysis",
                    value: "Jewelry Market Trends",
                  },
                ],
              },
            ],
          },
          "gdmr-entry": {
            sections: [
              {
                title: "Expansion Blueprint",
                items: [
                  { label: "New Markets", value: "Southeast Asia focus" },
                  { label: "Investment Outlook", value: "â‚¹5,000 Cr capex" },
                  { label: "Timeline", value: "3-year phased approach" },
                ],
              },
            ],
          },
        },
        shoppers: {
          name: "Shoppers Stop",
          logo: "logo/shoppers-stop-logo.png",
        },
        abfrl: {
          name: "Aditya Birla Fashion and Retail",
          logo: "logo/aditya_birla_fashion_and_retail_logo.png",
        },
        "page-industries": {
          name: "Page Industries (Jockey)",
          logo: "logo/jockey-logo.png",
        },
        "v-mart": { name: "V-Mart", logo: "logo/V-Mart.svg" },
        trent: { name: "Trent", logo: "logo/Trent.svg" },
        "go-fashion": {
          name: "Go Fashion (Go Colors)",
          logo: "logo/goColors.svg",
        },
        "avenue-supermarts": {
          name: "Avenue Supermarts (DMart)",
          logo: "logo/DMartLogoVector.svg.png",
        },
        "arvind-fashion": {
          name: "Arvind Fashion",
          logo: "logo/the-arvind-store-seeklogo.png",
        },
      };

      // State management
      let currentCompany = null;
      let currentTopic = null;
      let isAnimating = false;

      // DOM elements
      const companySidebar = document.getElementById("companySidebar");
      const topicsSidebar = document.getElementById("topicsSidebar");
      const contentArea = document.querySelector(".content-area");
      const mainContent = document.querySelector(".main-content");

      function generateContentHTML(company, topic) {
        if (company && topic) {
          const data = companyData[company];
          const topicTitle =
            topic.charAt(0).toUpperCase() + topic.slice(1).replace("-", " ");
          const logoHTML = data.logo
            ? `<div class="header-logo-container"><img src="${data.logo}" alt="${data.name} Logo" class="header-logo"></div>`
            : "";

          const topicData = data?.[topic];

          if (!topicData) {
            const headerTextHTML = `<div><h3>Data Not Available</h3><p>Content for ${topicTitle} is being prepared for ${data.name}</p></div>`;
            return `<div class="card-header">${headerTextHTML}${logoHTML}</div>
                    <div class="data-section"><h4>Coming Soon</h4><p>Detailed analysis and reports will be available shortly.</p></div>`;
          }

          const sectionsHTML = topicData.sections
            .map((section) => {
              const itemsHTML = section.items
                .map(
                  (item) =>
                    `<div class="data-item"><strong>${item.label}:</strong> ${item.value}</div>`
                )
                .join("");
              return `<div class="data-section"><h4>${section.title}</h4><div class="data-grid">${itemsHTML}</div></div>`;
            })
            .join("");

          const headerTextHTML = `<div><h3>${topicTitle}</h3><p>${data.name}</p></div>`;
          return `<div class="card-header">${headerTextHTML}${logoHTML}</div>${sectionsHTML}`;
        }

        if (company && !topic) {
          const companyInfo = companyData[company];
          let placeholderHTML;
          if (companyInfo.logo) {
            placeholderHTML = `<div class="logo-wrapper"><img src="${companyInfo.logo}" alt="${companyInfo.name} Logo"><div class="company-name">${companyInfo.name}</div></div>`;
          } else {
            placeholderHTML = `<div class="logo-wrapper placeholder"><span class="logo-placeholder-text">${companyInfo.name}</span></div>`;
          }
          return `<div class="welcome-screen">${placeholderHTML}</div>`;
        }

        if (!company && !topic) {
          return `<div id="welcomeScreen" class="welcome-screen">
              <img src="logo/gdmr-logo.png" alt="GDMR Logo" class="logo" />
              <h2>Welcome to the Research Dashboard</h2>
              <p>Select a topic from the left and a company from the right to begin your analysis.</p>
              <p>Use Arrow Keys to navigate.</p>
            </div>`;
        }
        if (topic) {
          // Only topic is selected
          return `<div class="welcome-screen"><h2>${topic.replace(
            "-",
            " "
          )}</h2><p>Now choose a company.</p></div>`;
        }
        return ""; // Should not happen
      }

      function toggleFullScreen() {
        if (!document.fullscreenElement) {
          mainContent
            .requestFullscreen()
            .catch((err) => showToast(`Fullscreen error: ${err.message}`));
        } else {
          document.exitFullscreen();
        }
      }

      function setupEventListeners() {
        document.addEventListener("keydown", (e) => {
          switch (e.key) {
            case "ArrowUp":
              e.preventDefault();
              navigate("company", "prev");
              break;
            case "ArrowDown":
              e.preventDefault();
              navigate("company", "next");
              break;
            case "ArrowLeft":
              e.preventDefault();
              navigate("topic", "prev");
              break;
            case "ArrowRight":
              e.preventDefault();
              navigate("topic", "next");
              break;
            case "Enter":
              e.preventDefault();
              toggleFullScreen();
              break;
          }
        });

        topicsSidebar.addEventListener("click", (e) => {
          const topicItem = e.target.closest(".sidebar-item");
          if (!topicItem) return;
          currentTopic = topicItem.dataset.topic;
          updateActive(topicsSidebar, topicItem);
          showContent();
        });

        companySidebar.addEventListener("click", (e) => {
          const companyItem = e.target.closest(".sidebar-item");
          if (!companyItem) return;
          currentCompany = companyItem.dataset.company;
          updateActive(companySidebar, companyItem);
          showContent();
        });

        document
          .getElementById("prevTopicBtn")
          .addEventListener("click", () => navigate("topic", "prev"));
        document
          .getElementById("nextTopicBtn")
          .addEventListener("click", () => navigate("topic", "next"));
        const fullscreenBtn = document.getElementById("fullscreenBtn");
        fullscreenBtn.addEventListener("click", toggleFullScreen);
        document.addEventListener("fullscreenchange", () => {
          fullscreenBtn.textContent = document.fullscreenElement
            ? "Exit Fullscreen"
            : "Fullscreen";
        });
      }

      function showContent(direction = "fade") {
        if (isAnimating) return;

        const oldContainer = contentArea.querySelector(".content-wrapper");
        if (
          oldContainer &&
          oldContainer.dataset.company === (currentCompany || "") &&
          oldContainer.dataset.topic === (currentTopic || "")
        )
          return;

        isAnimating = true;

        const newContainer = document.createElement("div");
        newContainer.className = "content-wrapper";
        newContainer.dataset.company = currentCompany || "";
        newContainer.dataset.topic = currentTopic || "";
        newContainer.innerHTML = generateContentHTML(
          currentCompany,
          currentTopic
        );

        const animPrep =
          {
            fade: "prepare-fade",
            up: "prepare-enter-from-bottom",
            down: "prepare-enter-from-top",
            left: "prepare-enter-from-right",
            right: "prepare-enter-from-left",
          }[direction] || "prepare-fade";
        const animExit =
          {
            fade: "exit-fade",
            up: "exit-to-top",
            down: "exit-to-bottom",
            left: "exit-to-left",
            right: "exit-to-right",
          }[direction] || "exit-fade";

        newContainer.classList.add(animPrep);
        contentArea.appendChild(newContainer);

        requestAnimationFrame(() => {
          if (oldContainer) oldContainer.classList.add(animExit);
          newContainer.classList.add("is-entering");
        });

        const animationTimeout =
          parseFloat(
            getComputedStyle(document.documentElement).getPropertyValue(
              "--animation-duration"
            ) || "0.45"
          ) * 1000;

        const cleanup = () => {
          oldContainer?.remove();
          newContainer.classList.remove(animPrep, "is-entering");
          isAnimating = false;
          newContainer.removeEventListener("transitionend", cleanup);
        };
        newContainer.addEventListener("transitionend", cleanup);
        setTimeout(cleanup, animationTimeout + 50); // Safety cleanup
      }

      function navigate(type, direction) {
        const isCompany = type === "company";
        const sidebar = isCompany ? companySidebar : topicsSidebar;
        const items = Array.from(sidebar.querySelectorAll(".sidebar-item"));
        if (items.length === 0) return;

        const currentIndex = items.findIndex((item) =>
          item.classList.contains("active")
        );
        let nextIndex;

        if (direction === "next") {
          if (currentIndex === items.length - 1) {
            showToast(`Last ${type}`);
            return;
          }
          nextIndex = currentIndex + 1;
        } else {
          // prev
          if (currentIndex <= 0) {
            // Handles -1 (no selection) and 0 (first item)
            if (currentIndex === 0) {
              // If it's the first item, deselect to go to the welcome/neutral state
              if (isCompany) {
                currentCompany = null;
                currentTopic = null;
                updateActive(companySidebar, null);
                showContent("fade");
              } else {
                currentTopic = null;
                updateActive(topicsSidebar, null);
                showContent("left");
              }
            }
            // If nothing was selected (currentIndex is -1), or after deselecting, stop.
            return;
          }
          nextIndex = currentIndex - 1;
        }

        const newItem = items[nextIndex];
        if (isCompany) {
          currentCompany = newItem.dataset.company;
          updateActive(companySidebar, newItem);
          showContent(direction === "next" ? "up" : "down");
        } else {
          currentTopic = newItem.dataset.topic;
          updateActive(topicsSidebar, newItem);
          showContent(direction === "next" ? "left" : "right");
        }
      }

      function updateActive(sidebar, activeItem, updateMobile = true) {
        sidebar
          .querySelectorAll(".sidebar-item")
          .forEach((item) => item.classList.remove("active"));
        if (activeItem) {
          activeItem.classList.add("active");
        }

        if (updateMobile && window.matchMedia("(max-width: 768px)").matches) {
          if (sidebar === companySidebar) {
            document.querySelector("#mobileCompanySelectorBtn").textContent =
              activeItem ? activeItem.textContent : "Select Company";
            document
              .querySelectorAll("#mobileCompanyNav .sidebar-item")
              .forEach((item) => item.classList.remove("active"));
            if (activeItem) {
              document
                .querySelector(
                  `#mobileCompanyNav .sidebar-item[data-company="${activeItem.dataset.company}"]`
                )
                ?.classList.add("active");
            }
          } else {
            document.querySelector("#mobileTopicTitle").textContent = activeItem
              ? activeItem.textContent
              : "Topics";
          }
        }
      }

      function setupMobileNav() {
        const mobileNav = document.getElementById("mobileCompanyNav");
        const mobileNavList = mobileNav.querySelector(".mobile-nav-list");
        const openBtn = document.getElementById("mobileCompanySelectorBtn");
        const closeBtn = document.getElementById("closeMobileNavBtn");
        const backdrop = document.getElementById("mobileNavBackdrop");

        mobileNavList.innerHTML = companySidebar.innerHTML;
        mobileNavList.querySelector("h2").remove();

        const toggleNav = (open) => {
          mobileNav.classList.toggle("open", open);
          backdrop.classList.toggle("visible", open);
        };

        openBtn.addEventListener("click", () => toggleNav(true));
        closeBtn.addEventListener("click", () => toggleNav(false));
        backdrop.addEventListener("click", () => toggleNav(false));

        mobileNavList.addEventListener("click", (e) => {
          const companyItem = e.target.closest(".sidebar-item");
          if (!companyItem) return;
          currentCompany = companyItem.dataset.company;
          updateActive(
            companySidebar,
            document.querySelector(
              `.sidebar-item[data-company="${currentCompany}"]`
            )
          );
          showContent();
          toggleNav(false);
        });
      }

      function showToast(message) {
        const existingToast = document.querySelector(".toast-notification");
        if (existingToast) existingToast.remove();
        const toast = document.createElement("div");
        toast.className = "toast-notification";
        toast.textContent = message;
        document.body.appendChild(toast);
        setTimeout(() => toast.classList.add("show"), 10);
        setTimeout(() => {
          toast.classList.remove("show");
          setTimeout(() => toast.parentElement?.removeChild(toast), 500);
        }, 2000);
      }

      function initializeSampleData() {
        const companies = [
          "shoppers",
          "abfrl",
          "page-industries",
          "v-mart",
          "trent",
          "go-fashion",
          "avenue-supermarts",
          "arvind-fashion",
        ];
        companies.forEach((c) => {
          if (!companyData[c]?.management) {
            // Check if full data is missing
            const name = c
              .replace(/-/g, " ")
              .replace(/\b\w/g, (l) => l.toUpperCase());
            companyData[c] = {
              ...companyData[c],
              name,
              management: {
                sections: [
                  {
                    title: "Leadership Overview",
                    items: [{ label: "Data Status", value: "Being compiled" }],
                  },
                ],
              },
              financials: {
                sections: [
                  {
                    title: "Financial Analysis",
                    items: [
                      { label: "Report Status", value: "Under preparation" },
                    ],
                  },
                ],
              },
              focus: {
                sections: [
                  {
                    title: "Strategic Focus",
                    items: [{ label: "Analysis Status", value: "In progress" }],
                  },
                ],
              },
              "supporting-files": {
                sections: [
                  {
                    title: "Document Repository",
                    items: [{ label: "Status", value: "Organizing documents" }],
                  },
                ],
              },
              "gdmr-entry": {
                sections: [
                  {
                    title: "Entry Strategy",
                    items: [
                      { label: "Research Status", value: "Under development" },
                    ],
                  },
                ],
              },
            };
          }
        });
      }

      // Initialize the application
      initializeSampleData();
      setupEventListeners();
      if (window.matchMedia("(max-width: 768px)").matches) {
        setupMobileNav();
      }
      showContent();
    </script>
  </body>
</html>
